uuid: d5129804-28ab-43de-8282-f583f29c7fd2
langcode: en
status: true
dependencies: {  }
id: npcs
migration_tags: null
migration_group: eldrich_chars
label: NPCs
source:
  plugin: csv
  path: modules/custom/ep_import/characters/npcs.csv
  header_row_count: 1
  column_names:
    -
      name: name
    -
      based_on: based_on
    -
      book: book
    -
      background: background
    -
      faction: faction
    -
      motivations: motivations
    -
      quote: quote
    -
      description: description
    -
      stats: stats
    -
      morph: morph
    -
      skills: skills
    -
      augmentations: augmentations
    -
      traits: traits
    -
      sleights: sleights
    -
      gear: gear
    -
      weapons: weapons
    -
      armor: armor
    -
      credits: credits
    -
      rep: rep
  keys:
    - name
process:
  title: name
  type:
    plugin: default_value
    default_value: npc
  field_description/value: description
  field_quote/value: quote
  field_stats:
    plugin: stat_block
    source: stats
  field_skills:
    -
      plugin: skip_on_empty
      method: process
      source: skills
    -
      plugin: explode
      delimiter: ','
    -
      plugin: skill_lookup
      destination_field: target_id
      entity_type: node
      bundle: skill
      bundle_key: type
      value_key: title
  field_augmentations:
    plugin: entity_lookup_plus
    destination_field: target_id
    value_key: title
    fallback_value_key: field_short_name
    bundle: augmentation
    bundle_key: type
    entity_type: node
    source: augmentations
  field_traits:
    plugin: entity_lookup_plus
    destination_field: target_id
    value_key: title
    bundle: trait
    bundle_key: type
    entity_type: node
    source: traits
  field_sleights:
    plugin: entity_lookup_plus
    destination_field: target_id
    value_key: title
    bundle: sleight
    bundle_key: type
    entity_type: node
    source: sleights

  field_morph:
    plugin: morph_instance
    source:
      - morph

  rep:
    plugin: entity_lookup_plus
    value_key: field_code
    bundle: network
    bundle_key: type
    extra_value_key: quantity
    entity_type: node
    source: rep
  faction:
    plugin: entity_lookup_plus
    value_key: title
    bundle: faction
    bundle_key: type
    entity_type: node
    source: faction
  field_identity:
    plugin: reference_factory
    entity_type: component
    keys:
      - field_faction
      - field_background
      - field_credits
      - field_rep
    source:
      - @faction
      - background
      - credits
      - @rep
    default_values:
      type: identity

  field_equipped_weapons:
    plugin: equipped_weapon
    source: weapons
  field_equipped_armor:
    plugin: equipped_armor
    source: armor
  field_credits: credits
  field_rep:

  citation:
    plugin: source_with_page
    entity_type: node
    bundle: source
    bundle_key: type
    value_key: field_code
    source: book
  field_attribution:
    plugin: reference_factory
    entity_type: component
    source:
      - '@citation'
    keys:
      - field_attribution_citations
    default_values:
      type: attribution
destination:
  plugin: 'entity:node'
migration_dependencies: null
